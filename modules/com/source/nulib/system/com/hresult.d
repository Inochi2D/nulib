/**
    Windows Error Definitions

    Basic standalone Windows definitions to make it easier to work with
    the COM API.

    Copyright: Copyright © 2023-2025, Kitsunebi Games
    Copyright: Copyright © 2023-2025, Inochi2D Project
    License:   $(LINK2 http://www.boost.org/LICENSE_1_0.txt, Boost License 1.0)
    Source:    $(DRUNTIMESRC core/sys/windows/_winerror.d)
    Authors:   Luna Nielsen
*/
module nulib.system.com.hresult;
import nulib.system.com.objbase;

alias HRESULT = int;
enum : HRESULT {
    S_OK                                   = 0x00000000,
    S_FALSE                                = 0x00000001,

    NOERROR                                = 0x00000000,

    E_PENDING                              = 0x8000000A,
    E_NOTIMPL                              = 0x80004001,
    E_NOINTERFACE                          = 0x80004002,
    E_POINTER                              = 0x80004003,
    E_ABORT                                = 0x80004004,
    E_FAIL                                 = 0x80004005,
    E_ACCESSDENIED                         = 0x80070005,
    E_HANDLE                               = 0x80070006,
    E_OUTOFMEMORY                          = 0x8007000E,
    E_INVALIDARG                           = 0x80070057,
    E_UNEXPECTED                           = 0x8000FFFF,

    CO_E_INIT_TLS                          = 0x80004006,
    CO_E_INIT_SHARED_ALLOCATOR             = 0x80004007,
    CO_E_INIT_MEMORY_ALLOCATOR             = 0x80004008,
    CO_E_INIT_CLASS_CACHE                  = 0x80004009,
    CO_E_INIT_RPC_CHANNEL                  = 0x8000400A,
    CO_E_INIT_TLS_SET_CHANNEL_CONTROL      = 0x8000400B,
    CO_E_INIT_TLS_CHANNEL_CONTROL          = 0x8000400C,
    CO_E_INIT_UNACCEPTED_USER_ALLOCATOR    = 0x8000400D,
    CO_E_INIT_SCM_MUTEX_EXISTS             = 0x8000400E,
    CO_E_INIT_SCM_FILE_MAPPING_EXISTS      = 0x8000400F,
    CO_E_INIT_SCM_MAP_VIEW_OF_FILE         = 0x80004010,
    CO_E_INIT_SCM_EXEC_FAILURE             = 0x80004011,
    CO_E_INIT_ONLY_SINGLE_THREADED         = 0x80004012,

    RPC_E_CALL_REJECTED                    = 0x80010001,
    RPC_E_CALL_CANCELED                    = 0x80010002,
    RPC_E_CANTPOST_INSENDCALL              = 0x80010003,
    RPC_E_CANTCALLOUT_INASYNCCALL          = 0x80010004,
    RPC_E_CANTCALLOUT_INEXTERNALCALL       = 0x80010005,
    RPC_E_CONNECTION_TERMINATED            = 0x80010006,
    RPC_E_SERVER_DIED                      = 0x80010007,
    RPC_E_CLIENT_DIED                      = 0x80010008,
    RPC_E_INVALID_DATAPACKET               = 0x80010009,
    RPC_E_CANTTRANSMIT_CALL                = 0x8001000A,
    RPC_E_CLIENT_CANTMARSHAL_DATA          = 0x8001000B,
    RPC_E_CLIENT_CANTUNMARSHAL_DATA        = 0x8001000C,
    RPC_E_SERVER_CANTMARSHAL_DATA          = 0x8001000D,
    RPC_E_SERVER_CANTUNMARSHAL_DATA        = 0x8001000E,
    RPC_E_INVALID_DATA                     = 0x8001000F,
    RPC_E_INVALID_PARAMETER                = 0x80010010,
    RPC_E_CANTCALLOUT_AGAIN                = 0x80010011,
    RPC_E_SERVER_DIED_DNE                  = 0x80010012,
    RPC_E_SYS_CALL_FAILED                  = 0x80010100,
    RPC_E_OUT_OF_RESOURCES                 = 0x80010101,
    RPC_E_ATTEMPTED_MULTITHREAD            = 0x80010102,
    RPC_E_NOT_REGISTERED                   = 0x80010103,
    RPC_E_FAULT                            = 0x80010104,
    RPC_E_SERVERFAULT                      = 0x80010105,
    RPC_E_CHANGED_MODE                     = 0x80010106,
    RPC_E_INVALIDMETHOD                    = 0x80010107,
    RPC_E_DISCONNECTED                     = 0x80010108,
    RPC_E_RETRY                            = 0x80010109,
    RPC_E_SERVERCALL_RETRYLATER            = 0x8001010A,
    RPC_E_SERVERCALL_REJECTED              = 0x8001010B,
    RPC_E_INVALID_CALLDATA                 = 0x8001010C,
    RPC_E_CANTCALLOUT_ININPUTSYNCCALL      = 0x8001010D,
    RPC_E_WRONG_THREAD                     = 0x8001010E,
    RPC_E_THREAD_NOT_INIT                  = 0x8001010F,
    RPC_E_UNEXPECTED                       = 0x8001FFFF,

    DISP_E_UNKNOWNINTERFACE                = 0x80020001,
    DISP_E_MEMBERNOTFOUND                  = 0x80020003,
    DISP_E_PARAMNOTFOUND                   = 0x80020004,
    DISP_E_TYPEMISMATCH                    = 0x80020005,
    DISP_E_UNKNOWNNAME                     = 0x80020006,
    DISP_E_NONAMEDARGS                     = 0x80020007,
    DISP_E_BADVARTYPE                      = 0x80020008,
    DISP_E_EXCEPTION                       = 0x80020009,
    DISP_E_OVERFLOW                        = 0x8002000A,
    DISP_E_BADINDEX                        = 0x8002000B,
    DISP_E_UNKNOWNLCID                     = 0x8002000C,
    DISP_E_ARRAYISLOCKED                   = 0x8002000D,
    DISP_E_BADPARAMCOUNT                   = 0x8002000E,
    DISP_E_PARAMNOTOPTIONAL                = 0x8002000F,
    DISP_E_BADCALLEE                       = 0x80020010,
    DISP_E_NOTACOLLECTION                  = 0x80020011,
    DISP_E_DIVBYZERO                       = 0x80020012,

    TYPE_E_BUFFERTOOSMALL                  = 0x80028016,
    TYPE_E_INVDATAREAD                     = 0x80028018,
    TYPE_E_UNSUPFORMAT                     = 0x80028019,
    TYPE_E_REGISTRYACCESS                  = 0x8002801C,
    TYPE_E_LIBNOTREGISTERED                = 0x8002801D,
    TYPE_E_UNDEFINEDTYPE                   = 0x80028027,
    TYPE_E_QUALIFIEDNAMEDISALLOWED         = 0x80028028,
    TYPE_E_INVALIDSTATE                    = 0x80028029,
    TYPE_E_WRONGTYPEKIND                   = 0x8002802A,
    TYPE_E_ELEMENTNOTFOUND                 = 0x8002802B,
    TYPE_E_AMBIGUOUSNAME                   = 0x8002802C,
    TYPE_E_NAMECONFLICT                    = 0x8002802D,
    TYPE_E_UNKNOWNLCID                     = 0x8002802E,
    TYPE_E_DLLFUNCTIONNOTFOUND             = 0x8002802F,
    TYPE_E_BADMODULEKIND                   = 0x800288BD,
    TYPE_E_SIZETOOBIG                      = 0x800288C5,
    TYPE_E_DUPLICATEID                     = 0x800288C6,
    TYPE_E_INVALIDID                       = 0x800288CF,
    TYPE_E_TYPEMISMATCH                    = 0x80028CA0,
    TYPE_E_OUTOFBOUNDS                     = 0x80028CA1,
    TYPE_E_IOERROR                         = 0x80028CA2,
    TYPE_E_CANTCREATETMPFILE               = 0x80028CA3,
    TYPE_E_CANTLOADLIBRARY                 = 0x80029C4A,
    TYPE_E_INCONSISTENTPROPFUNCS           = 0x80029C83,
    TYPE_E_CIRCULARTYPE                    = 0x80029C84,

    STG_E_INVALIDFUNCTION                  = 0x80030001,
    STG_E_FILENOTFOUND                     = 0x80030002,
    STG_E_PATHNOTFOUND                     = 0x80030003,
    STG_E_TOOMANYOPENFILES                 = 0x80030004,
    STG_E_ACCESSDENIED                     = 0x80030005,
    STG_E_INVALIDHANDLE                    = 0x80030006,
    STG_E_INSUFFICIENTMEMORY               = 0x80030008,
    STG_E_INVALIDPOINTER                   = 0x80030009,
    STG_E_NOMOREFILES                      = 0x80030012,
    STG_E_DISKISWRITEPROTECTED             = 0x80030013,
    STG_E_SEEKERROR                        = 0x80030019,
    STG_E_WRITEFAULT                       = 0x8003001D,
    STG_E_READFAULT                        = 0x8003001E,
    STG_E_SHAREVIOLATION                   = 0x80030020,
    STG_E_LOCKVIOLATION                    = 0x80030021,
    STG_E_FILEALREADYEXISTS                = 0x80030050,
    STG_E_INVALIDPARAMETER                 = 0x80030057,
    STG_E_MEDIUMFULL                       = 0x80030070,
    STG_E_ABNORMALAPIEXIT                  = 0x800300FA,
    STG_E_INVALIDHEADER                    = 0x800300FB,
    STG_E_INVALIDNAME                      = 0x800300FC,
    STG_E_UNKNOWN                          = 0x800300FD,
    STG_E_UNIMPLEMENTEDFUNCTION            = 0x800300FE,
    STG_E_INVALIDFLAG                      = 0x800300FF,
    STG_E_INUSE                            = 0x80030100,
    STG_E_NOTCURRENT                       = 0x80030101,
    STG_E_REVERTED                         = 0x80030102,
    STG_E_CANTSAVE                         = 0x80030103,
    STG_E_OLDFORMAT                        = 0x80030104,
    STG_E_OLDDLL                           = 0x80030105,
    STG_E_SHAREREQUIRED                    = 0x80030106,
    STG_E_NOTFILEBASEDSTORAGE              = 0x80030107,
    STG_E_EXTANTMARSHALLINGS               = 0x80030108,
    STG_S_CONVERTED                        = 0x00030200,

    OLE_E_FIRST                            = 0x80040000,
    OLE_S_FIRST                            = 0x00040000,
    OLE_E_OLEVERB                          = 0x80040000,
    OLE_S_USEREG                           = 0x00040000,
    OLE_E_ADVF                             = 0x80040001,
    OLE_S_STATIC                           = 0x00040001,
    OLE_E_ENUM_NOMORE                      = 0x80040002,
    OLE_S_MAC_CLIPFORMAT                   = 0x00040002,
    OLE_E_ADVISENOTSUPPORTED               = 0x80040003,
    OLE_E_NOCONNECTION                     = 0x80040004,
    OLE_E_NOTRUNNING                       = 0x80040005,
    OLE_E_NOCACHE                          = 0x80040006,
    OLE_E_BLANK                            = 0x80040007,
    OLE_E_CLASSDIFF                        = 0x80040008,
    OLE_E_CANT_GETMONIKER                  = 0x80040009,
    OLE_E_CANT_BINDTOSOURCE                = 0x8004000A,
    OLE_E_STATIC                           = 0x8004000B,
    OLE_E_PROMPTSAVECANCELLED              = 0x8004000C,
    OLE_E_INVALIDRECT                      = 0x8004000D,
    OLE_E_WRONGCOMPOBJ                     = 0x8004000E,
    OLE_E_INVALIDHWND                      = 0x8004000F,
    OLE_E_NOT_INPLACEACTIVE                = 0x80040010,
    OLE_E_CANTCONVERT                      = 0x80040011,
    OLE_E_NOSTORAGE                        = 0x80040012,

    DV_E_FORMATETC                         = 0x80040064,
    DV_E_DVTARGETDEVICE                    = 0x80040065,
    DV_E_STGMEDIUM                         = 0x80040066,
    DV_E_STATDATA                          = 0x80040067,
    DV_E_LINDEX                            = 0x80040068,
    DV_E_TYMED                             = 0x80040069,
    DV_E_CLIPFORMAT                        = 0x8004006A,
    DV_E_DVASPECT                          = 0x8004006B,
    DV_E_DVTARGETDEVICE_SIZE               = 0x8004006C,
    DV_E_NOIVIEWOBJECT                     = 0x8004006D,

    OLE_E_LAST                             = 0x800400FF,
    OLE_S_LAST                             = 0x000400FF,
    DRAGDROP_E_FIRST                       = 0x80040100,
    DRAGDROP_S_FIRST                       = 0x00040100,
    DRAGDROP_E_NOTREGISTERED               = 0x80040100,
    DRAGDROP_S_DROP                        = 0x00040100,
    DRAGDROP_E_ALREADYREGISTERED           = 0x80040101,
    DRAGDROP_S_CANCEL                      = 0x00040101,
    DRAGDROP_E_INVALIDHWND                 = 0x80040102,
    DRAGDROP_S_USEDEFAULTCURSORS           = 0x00040102,
    DRAGDROP_E_LAST                        = 0x8004010F,
    DRAGDROP_S_LAST                        = 0x0004010F,
    CLASSFACTORY_E_FIRST                   = 0x80040110,
    CLASSFACTORY_S_FIRST                   = 0x00040110,
    CLASS_E_NOAGGREGATION                  = 0x80040110,
    CLASS_E_CLASSNOTAVAILABLE              = 0x80040111,
    CLASSFACTORY_E_LAST                    = 0x8004011F,
    CLASSFACTORY_S_LAST                    = 0x0004011F,
    MARSHAL_E_FIRST                        = 0x80040120,
    MARSHAL_S_FIRST                        = 0x00040120,
    MARSHAL_E_LAST                         = 0x8004012F,
    MARSHAL_S_LAST                         = 0x0004012F,
    DATA_E_FIRST                           = 0x80040130,
    DATA_S_FIRST                           = 0x00040130,
    DATA_S_SAMEFORMATETC                   = 0x00040130,
    DATA_E_LAST                            = 0x8004013F,
    DATA_S_LAST                            = 0x0004013F,
    VIEW_E_FIRST                           = 0x80040140,
    VIEW_S_FIRST                           = 0x00040140,
    VIEW_E_DRAW                            = 0x80040140,
    VIEW_S_ALREADY_FROZEN                  = 0x00040140,
    VIEW_E_LAST                            = 0x8004014F,
    VIEW_S_LAST                            = 0x0004014F,
    REGDB_E_FIRST                          = 0x80040150,
    REGDB_S_FIRST                          = 0x00040150,
    REGDB_E_READREGDB                      = 0x80040150,
    REGDB_E_WRITEREGDB                     = 0x80040151,
    REGDB_E_KEYMISSING                     = 0x80040152,
    REGDB_E_INVALIDVALUE                   = 0x80040153,
    REGDB_E_CLASSNOTREG                    = 0x80040154,
    REGDB_E_IIDNOTREG                      = 0x80040155,
    REGDB_E_LAST                           = 0x8004015F,
    REGDB_S_LAST                           = 0x0004015F,
    CACHE_E_FIRST                          = 0x80040170,
    CACHE_S_FIRST                          = 0x00040170,
    CACHE_E_NOCACHE_UPDATED                = 0x80040170,
    CACHE_S_FORMATETC_NOTSUPPORTED         = 0x00040170,
    CACHE_S_SAMECACHE                      = 0x00040171,
    CACHE_S_SOMECACHES_NOTUPDATED          = 0x00040172,
    CACHE_E_LAST                           = 0x8004017F,
    CACHE_S_LAST                           = 0x0004017F,
    OLEOBJ_E_FIRST                         = 0x80040180,
    OLEOBJ_S_FIRST                         = 0x00040180,
    OLEOBJ_E_NOVERBS                       = 0x80040180,
    OLEOBJ_S_INVALIDVERB                   = 0x00040180,
    OLEOBJ_E_INVALIDVERB                   = 0x80040181,
    OLEOBJ_S_CANNOT_DOVERB_NOW             = 0x00040181,
    OLEOBJ_S_INVALIDHWND                   = 0x00040182,
    OLEOBJ_E_LAST                          = 0x8004018F,
    OLEOBJ_S_LAST                          = 0x0004018F,
    CLIENTSITE_E_FIRST                     = 0x80040190,
    CLIENTSITE_S_FIRST                     = 0x00040190,
    CLIENTSITE_E_LAST                      = 0x8004019F,
    CLIENTSITE_S_LAST                      = 0x0004019F,
    INPLACE_E_NOTUNDOABLE                  = 0x800401A0,
    INPLACE_E_FIRST                        = 0x800401A0,
    INPLACE_S_FIRST                        = 0x000401A0,
    INPLACE_S_TRUNCATED                    = 0x000401A0,
    INPLACE_E_NOTOOLSPACE                  = 0x800401A1,
    INPLACE_E_LAST                         = 0x800401AF,
    INPLACE_S_LAST                         = 0x000401AF,
    ENUM_E_FIRST                           = 0x800401B0,
    ENUM_S_FIRST                           = 0x000401B0,
    ENUM_E_LAST                            = 0x800401BF,
    ENUM_S_LAST                            = 0x000401BF,
    CONVERT10_E_FIRST                      = 0x800401C0,
    CONVERT10_S_FIRST                      = 0x000401C0,
    CONVERT10_E_OLESTREAM_GET              = 0x800401C0,
    CONVERT10_S_NO_PRESENTATION            = 0x000401C0,
    CONVERT10_E_OLESTREAM_PUT              = 0x800401C1,
    CONVERT10_E_OLESTREAM_FMT              = 0x800401C2,
    CONVERT10_E_OLESTREAM_BITMAP_TO_DIB    = 0x800401C3,
    CONVERT10_E_STG_FMT                    = 0x800401C4,
    CONVERT10_E_STG_NO_STD_STREAM          = 0x800401C5,
    CONVERT10_E_STG_DIB_TO_BITMAP          = 0x800401C6,
    CONVERT10_E_LAST                       = 0x800401CF,
    CONVERT10_S_LAST                       = 0x000401CF,
    CLIPBRD_E_FIRST                        = 0x800401D0,
    CLIPBRD_S_FIRST                        = 0x000401D0,
    CLIPBRD_E_CANT_OPEN                    = 0x800401D0,
    CLIPBRD_E_CANT_EMPTY                   = 0x800401D1,
    CLIPBRD_E_CANT_SET                     = 0x800401D2,
    CLIPBRD_E_BAD_DATA                     = 0x800401D3,
    CLIPBRD_E_CANT_CLOSE                   = 0x800401D4,
    CLIPBRD_E_LAST                         = 0x800401DF,
    CLIPBRD_S_LAST                         = 0x000401DF,
    MK_E_FIRST                             = 0x800401E0,
    MK_S_FIRST                             = 0x000401E0,
    MK_E_CONNECTMANUALLY                   = 0x800401E0,
    MK_E_EXCEEDEDDEADLINE                  = 0x800401E1,
    MK_E_NEEDGENERIC                       = 0x800401E2,
    MK_S_REDUCED_TO_SELF                   = 0x000401E2,
    MK_E_UNAVAILABLE                       = 0x800401E3,
    MK_E_SYNTAX                            = 0x800401E4,
    MK_S_ME                                = 0x000401E4,
    MK_E_NOOBJECT                          = 0x800401E5,
    MK_S_HIM                               = 0x000401E5,
    MK_E_INVALIDEXTENSION                  = 0x800401E6,
    MK_S_US                                = 0x000401E6,
    MK_E_INTERMEDIATEINTERFACENOTSUPPORTED = 0x800401E7,
    MK_S_MONIKERALREADYREGISTERED          = 0x000401E7,
    MK_E_NOTBINDABLE                       = 0x800401E8,
    MK_E_NOTBOUND                          = 0x800401E9,
    MK_E_CANTOPENFILE                      = 0x800401EA,
    MK_E_MUSTBOTHERUSER                    = 0x800401EB,
    MK_E_NOINVERSE                         = 0x800401EC,
    MK_E_NOSTORAGE                         = 0x800401ED,
    MK_E_NOPREFIX                          = 0x800401EE,
    MK_E_LAST                              = 0x800401EF,
    MK_S_LAST                              = 0x000401EF,
    MK_E_ENUMERATION_FAILED                = 0x800401EF,
    CO_E_FIRST                             = 0x800401F0,
    CO_S_FIRST                             = 0x000401F0,
    CO_E_NOTINITIALIZED                    = 0x800401F0,
    CO_E_ALREADYINITIALIZED                = 0x800401F1,
    CO_E_CANTDETERMINECLASS                = 0x800401F2,
    CO_E_CLASSSTRING                       = 0x800401F3,
    CO_E_IIDSTRING                         = 0x800401F4,
    CO_E_APPNOTFOUND                       = 0x800401F5,
    CO_E_APPSINGLEUSE                      = 0x800401F6,
    CO_E_ERRORINAPP                        = 0x800401F7,
    CO_E_DLLNOTFOUND                       = 0x800401F8,
    CO_E_ERRORINDLL                        = 0x800401F9,
    CO_E_WRONGOSFORAPP                     = 0x800401FA,
    CO_E_OBJNOTREG                         = 0x800401FB,
    CO_E_OBJISREG                          = 0x800401FC,
    CO_E_OBJNOTCONNECTED                   = 0x800401FD,
    CO_E_APPDIDNTREG                       = 0x800401FE,
    CO_E_LAST                              = 0x800401FF,
    CO_S_LAST                              = 0x000401FF,
    CO_E_RELEASED                          = 0x800401FF,

    CO_E_CLASS_CREATE_FAILED               = 0x80080001,
    CO_E_SCM_ERROR                         = 0x80080002,
    CO_E_SCM_RPC_FAILURE                   = 0x80080003,
    CO_E_BAD_PATH                          = 0x80080004,
    CO_E_SERVER_EXEC_FAILURE               = 0x80080005,
    CO_E_OBJSRV_RPC_FAILURE                = 0x80080006,
    MK_E_NO_NORMALIZED                     = 0x80080007,
    CO_E_SERVER_STOPPING                   = 0x80080008,
    MEM_E_INVALID_ROOT                     = 0x80080009,
    MEM_E_INVALID_LINK                     = 0x80080010,
    MEM_E_INVALID_SIZE                     = 0x80080011,
    CO_S_NOTALLINTERFACES                  = 0x00080012,

    NTE_BAD_UID                            = 0x80090001,
    NTE_BAD_HASH                           = 0x80090002,
    NTE_BAD_KEY                            = 0x80090003,
    NTE_BAD_LEN                            = 0x80090004,
    NTE_BAD_DATA                           = 0x80090005,
    NTE_BAD_SIGNATURE                      = 0x80090006,
    NTE_BAD_VER                            = 0x80090007,
    NTE_BAD_ALGID                          = 0x80090008,
    NTE_BAD_FLAGS                          = 0x80090009,
    NTE_BAD_TYPE                           = 0x8009000A,
    NTE_BAD_KEY_STATE                      = 0x8009000B,
    NTE_BAD_HASH_STATE                     = 0x8009000C,
    NTE_NO_KEY                             = 0x8009000D,
    NTE_NO_MEMORY                          = 0x8009000E,
    NTE_EXISTS                             = 0x8009000F,
    NTE_PERM                               = 0x80090010,
    NTE_NOT_FOUND                          = 0x80090011,
    NTE_DOUBLE_ENCRYPT                     = 0x80090012,
    NTE_BAD_PROVIDER                       = 0x80090013,
    NTE_BAD_PROV_TYPE                      = 0x80090014,
    NTE_BAD_PUBLIC_KEY                     = 0x80090015,
    NTE_BAD_KEYSET                         = 0x80090016,
    NTE_PROV_TYPE_NOT_DEF                  = 0x80090017,
    NTE_PROV_TYPE_ENTRY_BAD                = 0x80090018,
    NTE_KEYSET_NOT_DEF                     = 0x80090019,
    NTE_KEYSET_ENTRY_BAD                   = 0x8009001A,
    NTE_PROV_TYPE_NO_MATCH                 = 0x8009001B,
    NTE_SIGNATURE_FILE_BAD                 = 0x8009001C,
    NTE_PROVIDER_DLL_FAIL                  = 0x8009001D,
    NTE_PROV_DLL_NOT_FOUND                 = 0x8009001E,
    NTE_BAD_KEYSET_PARAM                   = 0x8009001F,
    NTE_FAIL                               = 0x80090020,
    NTE_SYS_ERR                            = 0x80090021
}

// C Macros
pragma(inline, true):
pure nothrow @nogc:
bool SUCCEEDED(HRESULT Status) { return Status >= 0; }
bool FAILED(HRESULT Status) { return Status < 0; }
bool IS_ERROR(HRESULT Status) { return (Status >>> 31) == 1; }
ushort HRESULT_CODE(HRESULT r) { return cast(ushort) (r & 0xFFFF);}
ushort HRESULT_FACILITY(HRESULT r) { return cast(ushort) ((r>>16) & 0x1fff); }
ushort HRESULT_SEVERITY(HRESULT r) { return cast(ushort) ((r>>31) & 0x1); }
HRESULT MAKE_HRESULT(bool s, uint f, uint c) { return (s << 31) | (f << 16) | c; }
HRESULT HRESULT_FROM_NT(HRESULT x) { return x | 0x10000000; }
HRESULT HRESULT_FROM_WIN32(HRESULT x) { return  x ? (x & 0x0000FFFF) | (7 << 16) | 0x80000000 : 0; }
